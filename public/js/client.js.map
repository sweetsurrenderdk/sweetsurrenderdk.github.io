{"version":3,"names":[],"mappings":"","sources":["client.js"],"sourcesContent":["\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n(function e(t, n, r) {\n    function s(o, u) {\n        if (!n[o]) {\n            if (!t[o]) {\n                var a = typeof require == \"function\" && require;if (!u && a) return a(o, !0);if (i) return i(o, !0);var f = new Error(\"Cannot find module '\" + o + \"'\");throw f.code = \"MODULE_NOT_FOUND\", f;\n            }var l = n[o] = { exports: {} };t[o][0].call(l.exports, function (e) {\n                var n = t[o][1][e];return s(n ? n : e);\n            }, l, l.exports, e, t, n, r);\n        }return n[o].exports;\n    }var i = typeof require == \"function\" && require;for (var o = 0; o < r.length; o++) {\n        s(r[o]);\n    }return s;\n})({ 1: [function (require, module, exports) {\n        require('./helpers/DebugHelper');\n        require('./helpers/MenuHelper');\n        require('./helpers/FacebookHelper');\n        require('./helpers/FormHelper');\n        require('./helpers/GalleryHelper');\n\n        // Globals\n        window.toggleWidget = function toggleWidget(name) {\n            if (document.body.dataset.activeWidget == name) {\n                closeWidgets();\n            } else {\n                document.body.dataset.activeWidget = name;\n            }\n        };\n\n        window.closeWidgets = function closeWidgets() {\n            document.body.dataset.activeWidget = '';\n        };\n\n        // Init\n        //FormHelper.init();\n        FacebookHelper.populateCalendar();\n        MenuHelper.bindNavItems();\n        GalleryHelper.bindImages();\n    }, { \"./helpers/DebugHelper\": 2, \"./helpers/FacebookHelper\": 3, \"./helpers/FormHelper\": 4, \"./helpers/GalleryHelper\": 5, \"./helpers/MenuHelper\": 6 }], 2: [function (require, module, exports) {\n        'use strict';\n\n        var lastSenderName = '';\n\n        var DebugHelper = function () {\n            function DebugHelper() {\n                _classCallCheck(this, DebugHelper);\n            }\n\n            _createClass(DebugHelper, null, [{\n                key: \"log\",\n\n                /**\n                 * Logs a message\n                 *\n                 * @param {String} message\n                 * @param {Object} sender\n                 * @param {Number} verbosity\n                 */\n                value: function log(message, sender, verbosity) {\n                    if (verbosity == 0) {\n                        this.error('Verbosity cannot be set to 0', this);\n                    } else if (!verbosity) {\n                        verbosity = 1;\n                    }\n\n                    if (this.verbosity >= verbosity) {\n                        console.log(this.parseSender(sender), this.getDateString(), message);\n                    }\n                }\n\n                /**\n                 * Gets the date string\n                 *\n                 * @returns {String} date\n                 */\n\n            }, {\n                key: \"getDateString\",\n                value: function getDateString() {\n                    var date = new Date();\n\n                    var output = '(' + date.getFullYear() + '/' + (date.getMonth() + 1) + '/' + date.getDate() + '-' + date.getHours() + ':' + date.getMinutes() + ':' + date.getSeconds() + ')';\n\n                    return output;\n                }\n\n                /**\n                 * Parse sender\n                 *\n                 * @param {Object} sender\n                 *\n                 * @returns {String} name\n                 */\n\n            }, {\n                key: \"parseSender\",\n                value: function parseSender(sender) {\n                    var senderName = '';\n\n                    if (sender) {\n                        if (typeof sender === 'function') {\n                            senderName += sender.name;\n                        } else if (sender.constructor) {\n                            senderName += sender.constructor.name;\n                        } else {\n                            senderName += sender.toString();\n                        }\n\n                        senderName;\n                    }\n\n                    if (senderName == lastSenderName) {\n                        senderName = '';\n                    } else {\n                        lastSenderName = senderName;\n                        senderName = '\\n' + senderName + '\\n----------\\n';\n                    }\n\n                    return senderName;\n                }\n\n                /**\n                 * Throws an error\n                 *\n                 * @param {String} message\n                 * @param {Object} sender\n                 */\n\n            }, {\n                key: \"error\",\n                value: function error(message, sender) {\n                    throw new Error(this.parseSender(sender) + ' ' + this.getDateString() + ' ' + message);\n                }\n\n                /**\n                 * Shows a warning\n                 */\n\n            }, {\n                key: \"warning\",\n                value: function warning(message, sender) {\n                    console.log(this.parseSender(sender), this.getDateString(), message);\n                    console.trace();\n                }\n            }]);\n\n            return DebugHelper;\n        }();\n\n        window.debug = DebugHelper;\n    }, {}], 3: [function (require, module, exports) {\n        'use strict';\n\n        var token = '927807870680835|0b5445c0ab8a3689ed727ab5bed0da1c';\n\n        var FacebookHelper = function () {\n            function FacebookHelper() {\n                _classCallCheck(this, FacebookHelper);\n            }\n\n            _createClass(FacebookHelper, null, [{\n                key: \"apiCall\",\n                value: function apiCall(url, query) {\n                    var _this = this;\n\n                    return new Promise(function (resolve, reject) {\n                        var xhr = new XMLHttpRequest();\n                        xhr.open('GET', 'https://graph.facebook.com/sweetsurrenderdk/' + url + '?access_token=' + token + query);\n                        xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');\n\n                        xhr.send();\n\n                        xhr.onreadystatechange = function () {\n                            var DONE = 4;\n                            var OK = 200;\n                            var NOT_MODIFIED = 304;\n\n                            if (xhr.readyState === DONE) {\n                                if (xhr.status == OK || xhr.status == NOT_MODIFIED) {\n                                    var response = xhr.responseText;\n\n                                    if (response && response != 'OK') {\n                                        try {\n                                            response = JSON.parse(response);\n                                        } catch (e) {\n                                            debug.log('Response: ' + response, _this);\n                                            debug.warning(e, _this);\n                                        }\n                                    }\n\n                                    resolve(response);\n                                } else {\n                                    reject(new Error(xhr.responseText));\n                                }\n                            }\n                        };\n                    });\n                }\n            }, {\n                key: \"populateCalendar\",\n                value: function populateCalendar() {\n                    var eventsElement = document.querySelector('.calendar-container .calendar-events');\n                    var eventElementTemplate = eventsElement.querySelector('.calendar-event');\n\n                    var autoLinker = new Autolinker();\n\n                    FacebookHelper.apiCall('events', '&fields=cover,name,start_time,end_time,description').then(function (response) {\n                        var upcoming = 0;\n                        var thisDate = new Date();\n\n                        for (var i = 0; i < response.data.length; i++) {\n                            var evt = response.data[i];\n                            var eventElement = eventElementTemplate.cloneNode(true);\n                            var description = evt.description;\n\n                            var start = new Date(evt.start_time);\n                            var end = new Date(evt.end_time);\n\n                            if (start > thisDate) {\n                                upcoming++;\n                            }\n\n                            eventElement.dataset.id = evt.id;\n\n                            if (evt.cover) {\n                                eventElement.querySelector('.cover').setAttribute('src', evt.cover.source);\n                            }\n\n                            description = autoLinker.link(description);\n\n                            eventElement.querySelector('.name').innerHTML = evt.name;\n                            eventElement.querySelector('.date').innerHTML = start.getDate() + '/' + (start.getMonth() + 1) + '/' + start.getFullYear();\n                            eventElement.querySelector('.description').innerHTML = description;\n\n                            var hours = eventElement.querySelector('.hours');\n\n                            hours.innerHTML = '';\n\n                            if (!isNaN(start.getHours())) {\n                                if (start.getHours().toString().length != 2) {\n                                    hours.innerHTML += '0' + start.getHours();\n                                } else {\n                                    hours.innerHTML += start.getHours();\n                                }\n\n                                if (start.getMinutes().toString().length != 2) {\n                                    hours.innerHTML += ':0' + start.getMinutes();\n                                } else {\n                                    hours.innerHTML += ':' + start.getMinutes();\n                                }\n\n                                if (!isNaN(end.getHours())) {\n                                    if (end.getHours().toString().length != 2) {\n                                        hours.innerHTML += ' - 0' + end.getHours();\n                                    } else {\n                                        hours.innerHTML += ' - ' + end.getHours();\n                                    }\n\n                                    if (end.getMinutes().toString().length != 2) {\n                                        hours.innerHTML += ':0' + end.getMinutes();\n                                    } else {\n                                        hours.innerHTML += ':' + end.getMinutes();\n                                    }\n                                }\n                            }\n\n                            var link = eventElement.querySelector('.fb-link');\n\n                            link.setAttribute('href', link.getAttribute('href') + evt.id);\n\n                            eventsElement.appendChild(eventElement);\n                        }\n\n                        eventElementTemplate.parentElement.removeChild(eventElementTemplate);\n\n                        if (upcoming > 0) {\n                            document.querySelector('.icon-calendar-new-events').innerHTML = upcoming.toString();\n                        } else {\n                            document.querySelector('.icon-calendar-new-events').style.display = 'none';\n                        }\n                    }).catch(function (e) {\n                        console.log(e);\n                    });\n                }\n            }]);\n\n            return FacebookHelper;\n        }();\n\n        window.FacebookHelper = FacebookHelper;\n    }, {}], 4: [function (require, module, exports) {\n        'use strict';\n\n        var FormHelper = function () {\n            function FormHelper() {\n                _classCallCheck(this, FormHelper);\n            }\n\n            _createClass(FormHelper, null, [{\n                key: \"apiCall\",\n                value: function apiCall(url, data) {\n                    var _this2 = this;\n\n                    return new Promise(function (resolve, reject) {\n                        var xhr = new XMLHttpRequest();\n                        xhr.open('POST', url);\n                        xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');\n                        xhr.setRequestHeader('Access-Control-Allow-Origin', location.protocol + '://' + location.hostname);\n\n                        xhr.send();\n\n                        xhr.onreadystatechange = function () {\n                            var DONE = 4;\n                            var OK = 200;\n                            var NOT_MODIFIED = 304;\n\n                            if (xhr.readyState === DONE) {\n                                if (xhr.status == OK || xhr.status == NOT_MODIFIED) {\n                                    var response = xhr.responseText;\n\n                                    if (response && response != 'OK') {\n                                        try {\n                                            response = JSON.parse(response);\n                                        } catch (e) {\n                                            debug.log('Response: ' + response, _this2);\n                                            debug.warning(e, _this2);\n                                        }\n                                    }\n\n                                    resolve(response);\n                                } else {\n                                    reject(new Error(xhr.responseText));\n                                }\n                            }\n                        };\n                    });\n                }\n            }, {\n                key: \"bindForm\",\n                value: function bindForm(form) {\n                    var _this3 = this;\n\n                    form.addEventListener('submit', function (e) {\n                        e.preventDefault();\n\n                        if (form.dataset.disabled) {\n                            return;\n                        }\n\n                        var serialized = {};\n\n                        for (var i = 0; i < form.elements.length; i++) {\n                            var element = form.elements[i];\n\n                            if (element.name) {\n                                serialized[element.name] = element.value;\n                            }\n                        }\n\n                        form.querySelector('input[type=\"submit\"').setAttribute('disabled', true);\n                        form.dataset.disabled = true;\n\n                        debug.log('Submitting form data...', _this3);\n\n                        FormHelper.apiCall( /*form.getAttribute('action')*/'http://jsonplaceholder.typicode.com/posts', serialized).then(function () {\n                            debug.log('Success!', _this3);\n                            form.querySelector('input[type=\"submit\"').setAttribute('disabled', false);\n                            form.dataset.disabled = false;\n                        }).catch(function (e) {\n                            form.dataset.disabled = false;\n                            alert(e);\n                        });\n                    });\n                }\n            }, {\n                key: \"init\",\n                value: function init() {\n                    var forms = document.querySelectorAll('form');\n\n                    for (var i = 0; i < forms.length; i++) {\n                        this.bindForm(forms[i]);\n                    }\n                }\n            }]);\n\n            return FormHelper;\n        }();\n\n        window.FormHelper = FormHelper;\n    }, {}], 5: [function (require, module, exports) {\n        'use strict';\n\n        var GalleryHelper = function () {\n            function GalleryHelper() {\n                _classCallCheck(this, GalleryHelper);\n            }\n\n            _createClass(GalleryHelper, null, [{\n                key: \"bindImages\",\n                value: function bindImages() {\n                    var images = document.querySelectorAll('section img, section .image');\n\n                    if (images) {\n                        for (var i = 0; i < images.length; i++) {\n                            var image = images[i];\n\n                            image.addEventListener('click', function () {\n                                var src = this.getAttribute('src');\n\n                                if (!src) {\n                                    src = this.style.backgroundImage;\n\n                                    src = src.replace('url(', '').replace(')', '').replace(/\\\"/gi, \"\");\n                                }\n\n                                GalleryHelper.openModal(src);\n                            });\n                        }\n                    }\n                }\n            }, {\n                key: \"openModal\",\n                value: function openModal(src) {\n                    // Render elements\n                    var modalBackdrop = document.createElement('div');\n                    modalBackdrop.className = 'modal-backdrop';\n\n                    var modal = document.createElement('div');\n                    modal.className = 'modal';\n\n                    var modalContent = document.createElement('div');\n                    modalContent.className = 'modal-content';\n\n                    var modalBody = document.createElement('img');\n                    modalBody.className = 'modal-body';\n                    modalBody.setAttribute('src', src);\n\n                    // Set up event listeners\n                    modalBackdrop.addEventListener('click', function () {\n                        modalBackdrop.classList.toggle('active', false);\n\n                        setTimeout(function () {\n                            if (modalBackdrop && modalBackdrop.parentElement) {\n                                modalBackdrop.parentElement.removeChild(modalBackdrop);\n                            }\n                        }, 500);\n                    });\n\n                    // Parent elements\n                    modalBackdrop.appendChild(modal);\n                    modal.appendChild(modalContent);\n                    modalContent.appendChild(modalBody);\n                    document.body.appendChild(modalBackdrop);\n\n                    // Wait a while and set active class\n                    setTimeout(function () {\n                        modalBackdrop.classList.toggle('active', true);\n                    }, 50);\n\n                    return modal;\n                }\n            }]);\n\n            return GalleryHelper;\n        }();\n\n        window.GalleryHelper = GalleryHelper;\n    }, {}], 6: [function (require, module, exports) {\n        'use strict';\n\n        var MenuHelper = function () {\n            function MenuHelper() {\n                _classCallCheck(this, MenuHelper);\n            }\n\n            _createClass(MenuHelper, null, [{\n                key: \"bindNavItem\",\n                value: function bindNavItem(navItem) {\n                    navItem.addEventListener('click', function () {\n                        MenuHelper.focusItem(navItem.dataset.id);\n\n                        closeWidgets();\n                    });\n                }\n            }, {\n                key: \"focusItem\",\n                value: function focusItem(id) {\n                    var galleryItem = document.querySelector('.menu-gallery .menu-item#_' + id);\n\n                    galleryItem.focus();\n                }\n            }, {\n                key: \"bindNavItems\",\n                value: function bindNavItems() {\n                    var navItems = document.querySelectorAll('.menu-page .menu-nav .menu-item');\n\n                    for (var i = 0; i < navItems.length; i++) {\n                        MenuHelper.bindNavItem(navItems[i]);\n                    }\n                }\n            }]);\n\n            return MenuHelper;\n        }();\n\n        window.MenuHelper = MenuHelper;\n    }, {}] }, {}, [1]);"],"file":"client.js","sourceRoot":"/source/"}